{
  "startNode": "INITIAL_STEP",
  "agents": [
    { "id": "greeting", "description": "Section of the flow that handles greeting" },
    { "id": "browse", "description": "Section of the flow that handles browsing" },
    { "id": "checkout", "description": "Section of the flow that handles checking-out" },
    { "id": "tracking", "description": "Section of the flow that handles order tracking" }
  ],
  "nodes": [
    {
      "id": "INITIAL_STEP",
      "text": "START",
      "kind": "agent",
      "nextNodeIsUser": true
    },
    {
      "id": "IdentifyFirstContact",
      "text": "Identificar si: 1) es un saludo com√∫n (hola), o 2) la b√∫squeda de un producto con imagen de referencia",
      "kind": "agent_decision",
      "description": "Identify whether it is a common greeting (hello) or a search for a product with a reference image",
      "agent": "greeting"
    },
    {
      "id": "GreetingAskName",
      "text": "¬°Un gusto tenerte en {BUSINESS_NAME}! Mi nombre es {BOT_NAME}. ¬øCu√°l es tu nombre?",
      "kind": "agent",
      "description": "Respond exactly with the response example below:",
      "agent": "greeting",
      "nextNodeIsUser": true
    },
    {
      "id": "UserSpecifiedName",
      "text": "REGISTER_NAME",
      "kind": "agent",
      "description": "Register the exact name as written by the user, to give a warm greeting",
      "agent": "greeting"
    },
    {
      "id": "AskNameImageSearch",
      "text": "Bueno, pues un gusto tenerte en {BUSINESS_NAME}. Mi nombre es {BOT_NAME}. Mientras busco el producto que enviaste, por favor dime, ¬øcu√°l es tu nombre?",
      "kind": "agent",
      "description": "Respond exactly with the response example below:",
      "agent": "greeting",
      "nextNodeIsUser": true
    },
    {
      "id": "UserSpecifiedNameImageSearch",
      "text": "REGISTER_NAME",
      "kind": "agent",
      "description": "Register the exact name as written by the user, to give a warm greeting",
      "agent": "greeting"
    },
    {
      "id": "RegisterUserNameImageSearch",
      "text": "Encantada de conocerte {USER_NAME}. Cu√©ntame, ¬øqu√© productos est√°s buscando hoy? Si gustas, aqu√≠ puedes encontrar el cat√°logo de nuestros productos: {CATALOG_URL}",
      "kind": "agent",
      "description": "Send an initial message that opens the conversation and invites the user to express their needs",
      "agent": "greeting"
    },
    {
      "id": "ReturnToCartWithoutAddingNewItems",
      "text": "The user wants to proceed with the products they already added to their cart without adding new items",
      "kind": "agent",
      "description": "Proceed to the customize order step with the products they already added to their cart.",
      "agent": "browse"
    },
    {
      "id": "RegisterUserName",
      "text": "Encantada de conocerte {USER_NAME}. Cu√©ntame, ¬øqu√© productos est√°s buscando hoy? Si gustas, aqu√≠ puedes encontrar el cat√°logo de nuestros productos: {CATALOG_URL}",
      "kind": "agent",
      "description": "Send an initial message that opens the conversation and invites the user to express their needs",
      "agent": "greeting",
      "nextNodeIsUser": true
    },
    {
      "id": "ContinueWithExistingUserName",
      "text": "¬°Me alegra tenerte de nuevo por aqu√≠, {USER_NAME}! Cu√©ntame, ¬øqu√© productos est√°s buscando hoy?",
      "kind": "agent",
      "description": "Send an initial message saluting the user by their name that opens the conversation and invites them to express their needs",
      "agent": "greeting",
      "nextNodeIsUser": true
    },
    {
      "id": "AskGenderAsSearchCriteria",
      "text": "Ok, ¬ølo necesitas para hombre o para mujer? (si el usuario ya mencion√≥ el genero arriba, pregutale por otra personalizaci√≥n, como la talla, el color, el uso que le quiere dar, el material, el almacenamiento, la capacidad (otra personalizaci√≥n): ¬øSerian camisas para mujer en qu√© talla? o  ¬øSerian pantalones para hombre en qu√© color?",
      "kind": "agent",
      "description": "If the user has already said the gender, ask for the size, but do not ask again if it is for women or men. **If they have already said it, note the gender user mentioned above**",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "ProceedWithGenderSelection",
      "text": "ProceedWithGenderSelection",
      "kind": "agent",
      "agent": "browse",
      "description": "Continues with product search after user specifies gender"
    },
    {
      "id": "SaveGenderBeforeSearch",
      "text": "SaveGenderBeforeSearch",
      "kind": "agent",
      "agent": "browse",
      "description": "Saves the user's gender preference before searching"
    },
    {
      "id": "UnderstandTheReference",
      "text": "Identificar si ya existe una foto de referencia del producto buscado",
      "kind": "agent_decision",
      "description": "Determine if the user has sent an image or not",
      "agent": "greeting"
    },
    {
      "id": "AskTheReferenceImage",
      "text": "¬øPuedes compartirme la imagen que viste? Con eso, busco el producto",
      "kind": "agent",
      "description": "Send a message asking the reference image to help them find the product. Example: '¬øPuedes compartirme la imagen que viste? Con eso, busco el producto",
      "agent": "greeting",
      "nextNodeIsUser": true
    },
    {
      "id": "NoProductsFound",
      "text": "Te cuento que acab√© de revisar en nuestro inventario y no tenemos: [mencionar el producto que busca el cliente]. ¬øQuieres que te ayude a encontrar algo similar?",
      "kind": "agent",
      "description": "Send a message being honest about no products were found, but asks sutile if: Is there any other product they would be interested?",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "CheckProductPersonalizationsSP",
      "text": "Checking personalization availability...",
      "kind": "agent",
      "description": "Check if the personalization (color/size/material) the user requested is available in the product's available options or If the personalization is not available. Do NOT respond to the user directly from this node - only make the routing decision.",
      "agent": "browse"
    },
    {
      "id": "AnswerProductPersonalizationsSP",
      "text": "Replies to a question about the availability of generic personalizations",
      "kind": "agent",
      "description": "Check in which personalizations (color/size/material) the user requested product is available in.",
      "agent": "browse"
    },
    {
      "id": "DoAnswerProductPersonalizationSP",
      "text": "Responde la pregunta del usuario y finaliza con algo como: ¬øContinuamos con la opcion que te mostr√©, o quieres buscar otro producto?",
      "kind": "agent",
      "description": "Use the availability information you received in the searchProduct tool's result to reply to the user question",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "AnswerProductPersonalizationsMP",
      "text": "Replies to a question about the availability of generic personalizations",
      "kind": "agent",
      "description": "Check in which personalizations (color/size/material) the user requested product is available in.",
      "agent": "browse"
    },
    {
      "id": "DoAnswerProductPersonalizationMP",
      "text": "Responde la pregunta del usuario y finaliza con algo como: ¬øContinuamos con alguna de las opciones que viste, o quieres buscar otro producto?",
      "kind": "agent",
      "description": "Use the availability information you received in the searchProduct tool's result to reply to the user question",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "ExistingPersonalizationSP",
      "text": "La personalizaci√≥n existe, se le debe mostrar al usuario",
      "kind": "agent",
      "description": "The requested personalization EXISTS in the product data.",
      "agent": "browse"
    },
    {
      "id": "NonExistingPersonalizationSP",
      "text": "Personalization not available - routing to inform user...",
      "kind": "agent",
      "description": "The requested personalization is NOT available in the product data. Route to InformNonExistingPersonalizationSP which will inform the user and offer alternatives (continue with available options or search for another product). Do NOT send a message from this node - it's a routing node only.",
      "agent": "browse"
    },
    {
      "id": "InformNonExistingPersonalizationSP",
      "text": "No est√° disponible en la personalizaci√≥n que lo buscas. Pero puedo buscarte algo similar, ¬øquieres que miremos?",
      "kind": "agent",
      "description": "Informs the user about the personalization they are asking for are not available and propose action",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "CheckProductPersonalizationsMP",
      "text": "Checking personalization availability...",
      "kind": "agent",
      "description": "Check if the requested personalization exists for a product that you already showed to the user. Indicate whether this option is available or unavailable. Do NOT respond to the user directly - only make the routing decision.",
      "agent": "browse"
    },
    {
      "id": "AskForNewDifferentProduct",
      "text": "Checking for new product availability...",
      "kind": "agent",
      "description": "Verify whether a new product name, not previously displayed, offers a specific personalization. Indicate whether this option is available or unavailable. Do NOT respond to the user directly - only make the routing decision.",
      "agent": "browse"
    },
    {
      "id": "ExistingPersonalizationMP",
      "text": "La personalizaci√≥n existe, se le debe mostrar al usuario",
      "kind": "agent",
      "description": "The requested personalization EXISTS for the specified product.",
      "agent": "browse"
    },
    {
      "id": "NonExistingPersonalizationMP",
      "text": "Personalization not available - routing to inform user...",
      "kind": "agent",
      "description": "The requested personalization is NOT available for the specified product. Route to InformNonExistingPersonalizationMP which will inform the user and offer alternatives (continue with available options or search for another product). Do NOT send a message from this node - it's a routing node only.",
      "agent": "browse"
    },
    {
      "id": "InformNonExistingPersonalizationMP",
      "text": "No est√° disponible en la personalizaci√≥n que lo buscas. Pero puedo buscarte algo similar, ¬øquieres que miremos?",
      "kind": "agent",
      "description": "Informs the user about the personalization they are asking for are not available and propose action",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "SearchIntent",
      "text": "PRODUCT_SEARCH",
      "kind": "agent",
      "description": "Search for products in the catalog based on user input (text description, image reference, product characteristics, price range, color, size, talla, material, price range, style, gender, any descriptive characteristics).",
      "agent": "browse"
    },
    {
      "id": "SingleProduct",
      "text": "Mira, estuve buscando y te encontr√© esta opci√≥n: <PRODUCT CARD> ¬øCumple con lo que buscabas?",
      "kind": "agent",
      "description": "DO NOT CHANGE the product card format you received, return it exactly as you got it.",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "MultipleProducts",
      "text": "Estaba buscando, y encontr√© est√°s opciones: <PRODUCT CARD> ¬øCu√°l te gusta?",
      "kind": "agent",
      "description": "DO NOT CHANGE the product card format you received, return it exactly as you got it.",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "AskInformation",
      "text": "Responde usando el historial de la descripci√≥n de los productos",
      "kind": "agent",
      "description": "Respond using the product search tool's results history. You already have this information from the product description. For example: 'The available colors and sizes are:[X, Y, Z]'",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "AnswerProductQuestionSP",
      "text": "<RESPUESTA A LA PREGUNTA> ¬øCon cu√°l producto te gustar√≠a continuar?",
      "kind": "agent",
      "description": "Respond using the product search tool's results history and conversation context. You already have this information from the product description.",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "AnswerProductQuestionMP",
      "text": "<RESPUESTA A LA PREGUNTA> ¬øTe gustar√≠a continuar con este producto?",
      "kind": "agent",
      "description": "Respond using the product search tool's results history and conversation context. You already have this information from the product description.",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "AskChanges",
      "text": "Entiendo. ¬øQu√© caracter√≠stica le cambiar√≠as y te consigo algo mejor?",
      "kind": "agent",
      "description": "Ask what the user would change to refine the search",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "NotInterestedInSeeingAnyMore",
      "text": "Vale, ¬øCrees que puedo ayudarte en algo m√°s?",
      "kind": "agent",
      "description": "Thank the user and ask if you can help with anything else",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "ConfirmAddCart",
      "text": "¬øQuieres ordenar este producto? üõí",
      "kind": "agent",
      "description": "Propose adding the chosen product to the user`s shopping cart",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "AskQuantity",
      "text": "¬øCu√°ntas unidades quieres llevar?",
      "kind": "agent",
      "description": "Request the quantity of units to add",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "AskMultipleQuantities",
      "text": "¬øCu√°ntas unidades de cada producto quieres llevar?",
      "kind": "agent",
      "description": "Request the quantity of each kind of product they want to add. Ask using a list schema",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "VerifyProductsWereAddedToCart",
      "text": "Verify that the products were added to the cart",
      "kind": "agent_decision",
      "description": "Check if the tool's response confirms that the items were successfully added to the cart or if it reports that they could NOT be added due to an error",
      "agent": "browse"
    },
    {
      "id": "ProductsWereNotAddedToCart",
      "text": "No pude agregar: <PRODUCTO CON ERROR> a tu carrito, porque: <MENCIONA EL ERROR>",
      "kind": "agent",
      "description": "Inform the user of the error that occurred when adding the item to the cart, and ask them what they want to do with the product that failed",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "WhatPersonalizationHasEnoughStock",
      "text": "Hay inventario suficiente en: <MENCIONA LAS PERSONALIZACIONES CON STOCK SUFICIENTE QUE RETORNO LA TOOL AddMultipleItemsToCart>",
      "kind": "agent",
      "description": "Inform the user which customizations have sufficient stock based on the previous result addMultipleItemsToCart tool just returned",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "CartOptions",
      "text": "Listo, los productos ya est√°n en tu carrito. Ahora, ¬øQuieres continuar al pago? üõí, o ¬øTe gustaria seguir comprando m√°s cosas? üîç",
      "kind": "agent",
      "description": "Confirm products added and Offer next actions: finalize current order or continue shopping",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "BuyMoreItems",
      "text": "Cu√©ntame, ¬øen qu√© color o talla buscas el otro producto que quieres comprar?",
      "kind": "agent",
      "description": "Please request the size, color, and material details to ensure accurate product searches based on the user's preferences.",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "WhichRemove",
      "text": "¬øCu√°l producto deseas eliminar? Producto 1... Producto 2...",
      "kind": "agent",
      "description": "Ask the user which product to remove",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "RemoveSuccess",
      "text": "‚úÖ Producto eliminado del carrito",
      "kind": "agent",
      "description": "Confirm that the item was removed from the cart",
      "agent": "browse"
    },
    {
      "id": "WhichReplace",
      "text": "¬øCu√°l producto quieres reemplazar? Producto 1... Producto 2...",
      "kind": "agent",
      "description": "Ask which cart product will be replaced",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "WhatInstead",
      "text": "¬øQu√© producto quieres agregar en su lugar?",
      "kind": "agent",
      "description": "Ask which product should be added as a replacement",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "CheckReplacementType",
      "text": "ANALYZE_REPLACEMENT_TYPE",
      "kind": "agent",
      "description": "Analyzes whether the user wants only change the personalization or user wants a product with different name",
      "agent": "browse"
    },
    {
      "id": "AddSameProductWithNewPersonalization",
      "text": "Agregando el mismo producto con la nueva personalizaci√≥n",
      "kind": "agent",
      "description": "Adds the same product to cart with the new personalization specified by the user",
      "agent": "browse"
    },
    {
      "id": "ShowCart",
      "text": "Tu carrito contiene: Productos: X, Y, Z",
      "kind": "agent",
      "description": "Present the current cart contents to the user",
      "agent": "browse"
    },
    {
      "id": "CustomLink",
      "text": "Revisa que tus personalizaciones esten bien, en este link: <LINK>. Y avisame cuando hayas confirmado tu pedido. Espero tu confirmaci√≥n para avanzar",
      "kind": "agent",
      "description": "Provide the link to the customization form and ask for confirmation when finished",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "RemindCustom",
      "text": "Para continuar, por favor completa el formulario en el link",
      "kind": "agent",
      "description": "Remind the user to complete the form if not yet done",
      "agent": "browse",
      "nextNodeIsUser": true
    },
    {
      "id": "AskCity",
      "text": "¬øEn qu√© ciudad est√°s ubicado?",
      "kind": "agent",
      "description": "Request the city to calculate shipping and coverage",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "CityHasExactMatch",
      "text": "Revisar√© la cobertura y el costo de env√≠o a: [Menciona la ciudad encontrada]",
      "kind": "agent",
      "description": "Continues with the process. This option is only available when the tool searchCityId returned one (1) unique single exact match. You can never choose this option if the search returned more than one city.",
      "agent": "checkout"
    },
    {
      "id": "ClarifyCity",
      "text": "Mira que no encontr√© la ciudad exacta que mencionaste. ¬øCu√°l de estas opciones es la tuya:",
      "kind": "agent",
      "description": "Asks the user to choose an alternative when there is no exact match",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "CalculatShippingFees",
      "text": "Calculates the shipping cost",
      "kind": "agent",
      "description": "Finds the shipping cost and coverage of the city",
      "agent": "checkout"
    },
    {
      "id": "InformShippingFees",
      "text": "Tu env√≠o tiene un costo de: $<PRICE>. ¬øContinuamos con el pago?",
      "kind": "agent",
      "description": "Inform the calculated shipping cost",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "CalculateTotalOnline",
      "text": "Calculates the total price for the order",
      "kind": "agent",
      "description": "Obtains the total price for this order",
      "agent": "checkout"
    },
    {
      "id": "ShowTotalOnline",
      "text": "El total a pagar en l√≠nea es de :$<PRICE>. ¬øConfirmas?",
      "kind": "agent",
      "description": "Shows the total to pay for online payment",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "AskDataOnline",
      "text": "Para procesar tu pedido enviame estos datos: \n1. Nombre completo\n2. Email\n3. C√©dula\n4. Direcci√≥n completa\n5. Barrio \n6. Detalles de tu direcci√≥n solo si los hay (ejemplo: Apto 301, Torre B, etc.)",
      "kind": "agent",
      "description": "Request the data required for online payment",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "RequestMissingDataOnline",
      "text": "Falt√≥ <Mencionar el dato que no pas√≥ la validaci√≥n o que el usuario olvid√≥ compartir>. Por favor, env√≠amelo",
      "kind": "agent",
      "description": "Request the missing or invalid data required for moving forward in the online payment",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "RequestMissingDataCOD",
      "text": "Falt√≥ <Mencionar el dato que no pas√≥ la validaci√≥n o que el usuario olvid√≥ compartir>. Por favor, env√≠amelo",
      "kind": "agent",
      "description": "Request the missing or invalid data required for moving forward in creating the cash on delivery order",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "ShowPayLink",
      "text": "Este es tu link de pago: [URL]",
      "kind": "agent",
      "description": "Provide the payment link so the user can complete the charge",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "ShowTotalCOD",
      "text": "Total contra entrega: $<PRICE>",
      "kind": "agent",
      "description": "Show the total to pay for cash on delivery",
      "agent": "checkout"
    },
    {
      "id": "ShowOrderSummary",
      "text": "Confirmame si est√° de acuerdo con el total a pagar:\nüì¶ Resumen del Pedido\n‚Ä¢ Producto 1: $X\n‚Ä¢ Producto 2: $Y\nüí∞ Subtotal: $Z\nüöö Env√≠o: $A\nüí≥ M√©todo de pago: $B\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚úÖ Total: $C",
      "kind": "agent",
      "description": "Present the final order summary structured to receive confirmation from user",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "AskDataCOD",
      "text": "Para procesar tu pedido enviame estos datos: \n1. Nombre completo\n2. Email\n3. C√©dula\n4. Direcci√≥n completa\n5. Barrio \n6. Detalles de tu direcci√≥n solo si los hay (ejemplo: Apto 301, Torre B, etc.)",
      "kind": "agent",
      "description": "Request the data required for cash on delivery",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "ValidateCODData",
      "text": "Validando datos para crear la orden",
      "kind": "agent",
      "description": "Validate the user's input against these specific requirements:\n(1) nombre: must be non-empty full name (first + last name),\n(2) email: must match valid email format (contains @ and domain),\n(3) documentoIdentidad: must be non-empty ID number (c√©dula) and it must have at maximum 10 digits, if it has more than 10 digits, you MUST reject this and ask for a valid number,\n(4) direccion: must be complete,\n5) barrio (string, MANDATORY): The neighborhood name (e.g., Laureles),\n6)  detalle (string, OPTIONAL): ONLY for apartment/tower/floor details like 'Apto 301', 'Torre B Piso 5', 'Conjunto Los Pinos'",
      "agent": "checkout"
    },
    {
      "id": "CreateCODOrder",
      "text": "Creando tu pedido contra entrega",
      "kind": "agent",
      "description": "Creates the cash on delivery order after all validation checks have passed. Please include apartement number or details if the user mentioned",
      "agent": "checkout"
    },
    {
      "id": "OrderSuccess",
      "text": "Listo, ya creamos tu pedido. Cuando tu n√∫mero de gu√≠a est√© listo te lo comparto",
      "kind": "agent",
      "description": "DO NOT CHANGE the order confirmation format you received, return it exactly as you got it",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "PaymentPending",
      "text": "‚ö†Ô∏è A√∫n no tenemos tu pago registrado. Por favor vuelve a intentarlo y conf√≠rmame",
      "kind": "agent",
      "description": "Inform that the payment is not yet registered and request a retry",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "OrderCancelled",
      "text": "Ok, hemos cancelado el pedido como lo solicitaste",
      "kind": "agent",
      "description": "Confirm that the order was canceled at the user's request",
      "agent": "checkout"
    },
    {
      "id": "SearchProduct",
      "text": "Analyzing search results...",
      "kind": "agent",
      "agent": "browse",
      "description": "Interpret the **searchProducts** tool results by examining the number of products returned by the tool. Make routing decision based ONLY on the result count from the tool, not on user input."
    },
    {
      "id": "ShowSingleImage",
      "text": "Sending product image...",
      "kind": "agent",
      "agent": "browse",
      "description": "Display an image to the user of the product requested. Do NOT ask questions, provide options, or send text messages. Your only task is show the requested product image. Use the IDs from the search results."
    },
    {
      "id": "ShowSeveralImages",
      "text": "Sending product options...",
      "kind": "agent",
      "agent": "browse",
      "description": "Display the requested images, at least show two images. If multiple personalizations exist for one product, pick one automatically. Use the IDs from the search results."
    },
    {
      "id": "GenerateProductCards",
      "text": "GenerateProductCards",
      "kind": "agent",
      "agent": "browse",
      "description": "Generate several product cards with information about price, personalization and product's benfits. Do NOT ask questions, provide options, or send text messages. Use the product IDs from the search results"
    },
    {
      "id": "GenerateProductCard",
      "text": "GenerateProductCard",
      "kind": "agent",
      "agent": "browse",
      "description": "Generate one product card with information about price, personalization and product's benfits. Do NOT ask questions, provide options, or send text messages. Use the product ID from the search results"
    },
    {
      "id": "UserSaidFormWasFilled",
      "text": "UserSaidFormWasFilled",
      "kind": "agent",
      "agent": "browse",
      "description": "Proceeds with the order once the user confirms they filled the form"
    },
    {
      "id": "ConfirmCustomFormWasFilled",
      "text": "ConfirmCustomFormWasFilled",
      "kind": "agent",
      "agent": "browse",
      "description": "Confirms if the user did fill the form indeed"
    },
    {
      "id": "RemindCustom1",
      "text": "RemindCustom1",
      "kind": "agent",
      "agent": "browse",
      "description": "Remind the user to complete the form if not yet done"
    },
    {
      "id": "RemindCustom2",
      "text": "RemindCustom2",
      "kind": "agent",
      "agent": "browse",
      "description": "Remind the user to complete the form if not yet done"
    },
    {
      "id": "ProceedWithGivenQuantity",
      "text": "ProceedWithGivenQuantity",
      "kind": "agent",
      "agent": "browse",
      "description": "Continues with the process once the user has specified the quantity"
    },
    {
      "id": "ProceedWithMultipleGivenQuantity",
      "text": "ProceedWithMultipleGivenQuantity",
      "kind": "agent",
      "agent": "browse",
      "description": "Continues with the multiple shopping process after the user has specified the quantity of each kind of product to add"
    },
    {
      "id": "CheckIfMultipleProducts",
      "text": "CHECK_MULTIPLE_PRODUCTS",
      "kind": "agent_decision",
      "agent": "browse",
      "description": "Determine if user wants to add only ONE kind of product or multiple kinds of products based on the conversation context"
    },
    {
      "id": "ContinueWithOrder",
      "text": "ContinueWithOrder",
      "kind": "agent",
      "agent": "browse",
      "description": "The user can use any of these words to signify that they want to continue with the order: 'terminar' / 'continuar' / 'finalizar' / 'avanzar' (all and similars are valid and you should understand them as a valid)"
    },
    {
      "id": "GetCart",
      "text": "GetCart",
      "kind": "agent",
      "agent": "browse",
      "description": "Allows the user to see their cart"
    },
    {
      "id": "RemoveItemFromCart",
      "text": "RemoveItemFromCart",
      "kind": "agent",
      "agent": "browse",
      "description": "Allows the user to delete a product from their cart"
    },
    {
      "id": "UserDidNotSpecifyItemToRemove",
      "text": "UserDidNotSpecifyItemToRemove",
      "kind": "agent",
      "agent": "browse",
      "description": "Request the user to specify which of all the items in their cart they want to remove, with customizations and literal quantities"
    },
    {
      "id": "UserSpecifiedItemToRemove",
      "text": "UserSpecifiedItemToRemove",
      "kind": "agent",
      "agent": "browse",
      "description": "The user specified the specific name of the product they want to remove"
    },
    {
      "id": "ReplaceItemFromCart",
      "text": "ReplaceItemFromCart",
      "kind": "agent",
      "agent": "browse",
      "description": "An item in the cart will be replaced with a new product that the user will select."
    },
    {
      "id": "UserSpecifiedItemToReplace",
      "text": "UserSpecifiedItemToReplace",
      "kind": "agent",
      "agent": "browse",
      "description": "The user DID specify the name of the product they want to replace"
    },
    {
      "id": "UserDidNotSpecifyItemToReplace",
      "text": "UserDidNotSpecifyItemToReplace",
      "kind": "agent",
      "agent": "browse",
      "description": "The user DID NOT specify the name of the product they want to remove neither the personalizations of the product to be removed"
    },
    {
      "id": "ReplaceItemSpecified",
      "text": "ReplaceItemSpecified",
      "kind": "agent",
      "agent": "browse",
      "description": "Ask which cart product will be replaced"
    },
    {
      "id": "UserSpecifiedCity",
      "text": "UserSpecifiedCity",
      "kind": "agent",
      "agent": "checkout",
      "description": "User specified the city"
    },
    {
      "id": "AskCity2",
      "text": "AskCity2",
      "kind": "agent",
      "agent": "checkout",
      "description": "Request the city to calculate shipping and coverage"
    },
    {
      "id": "ConfirmShippingToCity",
      "text": "ConfirmShippingToCity",
      "kind": "agent",
      "agent": "checkout",
      "description": "Use the cityID of the city chosen by the user to confirm the shipping cost"
    },
    {
      "id": "CityDoesNotExist",
      "text": "No encontr√© ninguna ciudad con ese nombre. Por favor, corrige el nombre de la ciudad y lo vuelvo a buscar",
      "kind": "agent",
      "description": "Inform the user that the city they specified does not exist and ask them to provide a valid city name",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "AskPayment",
      "text": "¬øCu√°l ser√° tu m√©todo de pago? Tenemos {PAYMENT_METHODS}",
      "kind": "agent",
      "description": "Request the preferred payment method",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "AskPaymentInvalidOption",
      "text": "No manejamos ese m√©todo de pago, sin embargo tenemos {PAYMENT_METHODS} ¬øCu√°l prefieres?",
      "kind": "agent",
      "agent": "checkout",
      "description": "Informs the chosen payment method is not available and request one valid preferred payment method",
      "nextNodeIsUser": true
    },
    {
      "id": "AskPayment1",
      "text": "AskPayment1",
      "kind": "agent",
      "agent": "checkout",
      "description": "User requested to pay online (ONLY credit/debit card or PSE). Keep in mind that transferences, Nequi, etc., are NOT valid options)"
    },
    {
      "id": "AskPayment2",
      "text": "AskPayment2",
      "kind": "agent",
      "agent": "checkout",
      "description": "User requested to pay in cash on-delivery"
    },
    {
      "id": "AskPayment3",
      "text": "AskPayment3",
      "kind": "agent",
      "agent": "checkout",
      "description": "User requested to pay with a transference"
    },
    {
      "id": "ValidateOnlineData",
      "text": "Validando datos para generar el link de pago",
      "kind": "agent",
      "description": "Validate the user's input against these specific requirements:\n(1) nombre: must be non-empty full name (first + last name),\n(2) email: must match valid email format (contains @ and domain),\n(3) documentoIdentidad: must be non-empty ID number (c√©dula) and it must have at maximum 10 digits, if it has more than 10 digits, you MUST reject this and ask for a valid number,\n(4) direccion: must be complete,\n5) barrio (string, MANDATORY): The neighborhood name (e.g., Laureles),\n6)  detalle (string, OPTIONAL): ONLY for apartment/tower/floor details like 'Apto 301', 'Torre B Piso 5', 'Conjunto Los Pinos'",
      "agent": "checkout"
    },
    {
      "id": "CreateOnlinePayment",
      "text": "Generando tu link de pago",
      "kind": "agent",
      "description": "Creates the online payment link after all validation checks have passed. Only calls the createPaymentLink tool from this node.",
      "agent": "checkout"
    },
    {
      "id": "ShowPayLink1",
      "text": "ShowPayLink1",
      "kind": "agent",
      "agent": "checkout",
      "description": "After user confirmed the payment we need to verify if the backend received the payment as the user mentioned"
    },
    {
      "id": "ShowPayLink2",
      "text": "ShowPayLink2",
      "kind": "agent",
      "agent": "checkout",
      "description": "Evaluate if the payment was received as the used confirmed"
    },
    {
      "id": "PaymentPending1",
      "text": "PaymentPending1",
      "kind": "agent",
      "agent": "checkout",
      "description": "Verify if the payment was registered or was not registered and request a retry"
    },
    {
      "id": "PaymentPending2",
      "text": "PaymentPending2",
      "kind": "agent",
      "agent": "checkout",
      "description": "Verify if the payment was registered or was not registered, and request a retry"
    },
    {
      "id": "CalculateTotalTransference",
      "text": "Calculates the total price for the transference order",
      "kind": "agent",
      "description": "Obtains the total price for this transference order",
      "agent": "checkout"
    },
    {
      "id": "ShowTotalTransference",
      "text": "Total a pagar por transferencia: $<PRICE>. ¬øConfirmas?",
      "kind": "agent",
      "description": "Shows the total to pay for transference payment",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "AskDataTransference",
      "text": "Para procesar tu pedido por transferencia env√≠ame estos datos: \n1. Nombre completo\n2. Email\n3. C√©dula\n4. Direcci√≥n completa\n5. Barrio \n6. Detalles de tu direcci√≥n solo si los hay (ejemplo: Apto 301, Torre B, etc.)",
      "kind": "agent",
      "description": "Request the data required for transference payment",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "ValidateTransferenceData",
      "text": "Validando datos para generar los datos de transferencia",
      "kind": "agent",
      "description": "Validate the user's input against these specific requirements:\n(1) nombre: must be non-empty full name (first + last name),\n(2) email: must match valid email format (contains @ and domain),\n(3) documentoIdentidad: must be non-empty ID number (c√©dula) and it must have at maximum 10 digits, if it has more than 10 digits, you MUST reject this and ask for a valid number,\n(4) direccion: must be complete,\n5) barrio (string, MANDATORY): The neighborhood name (e.g., Laureles),\n6) detalle (string, OPTIONAL): ONLY for apartment/tower/floor details like 'Apto 301', 'Torre B Piso 5', 'Conjunto Los Pinos'",
      "agent": "checkout"
    },
    {
      "id": "RequestMissingDataTransference",
      "text": "Falt√≥ <Mencionar el dato que no pas√≥ la validaci√≥n o que el usuario olvid√≥ compartir>. Por favor, env√≠amelo",
      "kind": "agent",
      "description": "Request the missing or invalid data required for moving forward in the transference payment",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "CreateTransferencePayment",
      "text": "Generando los datos para tu transferencia",
      "kind": "agent",
      "description": "Creates the transference payment after all validation checks have passed. Only calls the getTransferenceDetails tool from this node.",
      "agent": "checkout"
    },
    {
      "id": "ShowTransferenceDetails",
      "text": "Estos son los datos para realizar tu transferencia: [BANK_DETAILS]. Por favor confirma cuando hayas realizado el pago y env√≠a captura del comprobante",
      "kind": "agent",
      "description": "Provide the transference bank details so the user can complete the payment. Ask for screenshot confirmation.",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "AskPaymentScreenshot",
      "text": "¬øPuedes compartirme la captura de pantalla del comprobante de pago?",
      "kind": "agent",
      "description": "Request the payment screenshot as confirmation of the transference",
      "agent": "checkout",
      "nextNodeIsUser": true
    },
    {
      "id": "ShowTransferenceDetails1",
      "text": "Dame un momento mientras verifico la transferencia",
      "kind": "agent",
      "agent": "checkout",
      "description": "After user confirmed the transference payment we need to verify if the backend received the payment as the user mentioned"
    },
    {
      "id": "WaitForTransferenceConfirmation",
      "text": "Dame un momento mientras verifico la transferencia",
      "kind": "agent",
      "agent": "checkout",
      "description": "After user confirmed the transference payment we need to verify if we received the payment as the user mentioned",
      "nextNodeIsUser": true
    },
    {
      "id": "ShowTransferenceDetails2",
      "text": "Dame un momento mientras verifico la transferencia",
      "kind": "agent",
      "agent": "checkout",
      "description": "Evaluate if the transference payment was verified by human operator"
    },
    {
      "id": "PaymentPendingTransference",
      "text": "Ya revisamos y no hemos recibido tu pago. ¬øEst√°s seguro de que lo realizaste? Por favor, conf√≠rmame si s√≠ lo enviaste, y a qu√© cuenta.",
      "kind": "agent",
      "description": "Inform that the transference payment is was not received and request payment confirmation double check",
      "agent": "checkout"
    },
    {
      "id": "PaymentPendingTransference1",
      "text": "PaymentPendingTransference1",
      "kind": "agent",
      "agent": "checkout",
      "description": "Verify if the transference payment was verified or not, and request a retry",
      "nextNodeIsUser": true
    },
    {
      "id": "TrackingOrderStatus",
      "text": "Retrieving your order status...",
      "kind": "agent",
      "description": "Determine if the user has created orders and find the status of those orders",
      "agent": "tracking"
    },
    {
      "id": "InterpretOrderStatus",
      "text": "InterpretOrderStatus",
      "kind": "agent",
      "description": "Analyzes the getOrders tool response and determines the appropriate status response",
      "agent": "tracking"
    },
    {
      "id": "UserDoesNotNeedAnythingElse",
      "text": "Vale, entiendo, ten un buen d√≠a y gracias por considerarnos",
      "kind": "agent",
      "description": "Wish the user a good day and mention that you will be there for them when they need something else",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "OrderUnpaid",
      "text": "Tu pedido a√∫n no ha sido pagado. Necesitas completar el pago primero.",
      "kind": "agent",
      "description": "Inform user their order is unpaid",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "OrderPaidUnconfirmed",
      "text": "Tu pago fue recibido. Estamos confirmando tu pedido.",
      "kind": "agent",
      "description": "Inform user payment received and being confirmed",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "OrderConfirmed",
      "text": "Tu pedido est√° confirmado y se est√° preparando para env√≠o.",
      "kind": "agent",
      "description": "Inform user order is confirmed and being prepared",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "OrderSent",
      "text": "El pedido fue enviado. Decidir SI existe trackingId √≥ NO existe",
      "kind": "agent",
      "description": "Analyze and determine if the order includes tracking Id information",
      "agent": "tracking"
    },
    {
      "id": "OrderReceived",
      "text": "Seg√∫n nuestros registros, tu pedido ya fue entregado.",
      "kind": "agent",
      "description": "Inform user order was delivered",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "ReceiptInformation",
      "text": "Te comparto la gu√≠a de seguimiento",
      "kind": "agent",
      "description": "Share with the user the tool result of sendTrackingID",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "OrderCancelledTracking",
      "text": "Tu pedido fue cancelado.",
      "kind": "agent",
      "description": "Inform user order was cancelled",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "OrderPaymentFailed",
      "text": "Hubo un problema con tu pago. Contacta soporte para generar un nuevo link.",
      "kind": "agent",
      "description": "Inform user payment failed",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "NoOrdersFound",
      "text": "No encontr√© ning√∫n pedido asociado a tu cuenta.",
      "kind": "agent",
      "description": "Inform user they have no orders",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "TrackingIdNotFound",
      "text": "Tu pedido ya fue enviado, pero a√∫n no tengo el n√∫mero de la gu√≠a. Cuando el administrador la cargue, te la compartir√©.",
      "kind": "agent",
      "description": "Inform that the order was sent but the trackingId is not attached yet, in some time will be available",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "OfferTrackingGuide",
      "text": "Tu pedido ya fue enviado. Este es tu n√∫mero de gu√≠a: [trackingId]. ¬øTe env√≠o el PDF de la transportadora?",
      "kind": "agent",
      "description": "Ask user if they want to receive the PDF with the trackingId info",
      "agent": "tracking",
      "nextNodeIsUser": true
    },
    {
      "id": "UserWantsGuide",
      "text": "UserWantsGuide",
      "kind": "agent",
      "description": "Determines if user wants the tracking guide",
      "agent": "tracking"
    },
    {
      "id": "SendTrackingGuide",
      "text": "SendTrackingGuide",
      "kind": "agent",
      "description": "Sends tracking guide PDF using sendTrackingID tool",
      "agent": "tracking"
    },
    {
      "id": "TrackingGuideDeclined",
      "text": "Entendido, no enviar√© la gu√≠a.",
      "kind": "agent",
      "description": "Acknowledge user declined the tracking guide",
      "agent": "tracking"
    },
    {
      "id": "AskMoreTracking",
      "text": "¬øHay algo m√°s en lo que pueda ayudarte?",
      "kind": "agent",
      "description": "Ask if user needs more tracking assistance",
      "agent": "tracking",
      "nextNodeIsUser": true
    }
  ],
  "edges": [
    {
      "from": "INITIAL_STEP",
      "to": "IdentifyFirstContact",
      "preconditions": [
        { "type": "user_said", "value": "Busco un producto/referencia" }
      ]
    },
    {
      "from": "IdentifyFirstContact",
      "to": "GreetingAskName",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user said hello or introduced themselves, but did not say which product they wanted and did not send any pictures"
        }
      ],
      "contextPreconditions": { "preconditions": ["NO_USER_HAS_NAME"] }
    },
    {
      "from": "IdentifyFirstContact",
      "to": "ContinueWithExistingUserName",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user said hello or introduced themselves, but did not say which product they wanted and did not send any pictures"
        }
      ],
      "contextPreconditions": {
        "preconditions": ["USER_HAS_NAME"],
        "jumpTo": "RegisterUserName"
      }
    },
    {
      "from": "IdentifyFirstContact",
      "to": "UnderstandTheReference",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user said hello, but also either sent a picture to show what product he wanted or said he was looking for a specific product"
        }
      ]
    },
    {
      "from": "UnderstandTheReference",
      "to": "SearchProduct",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user has already sent an image of the product."
        }
      ],
      "contextPreconditions": { "preconditions": ["USER_HAS_NAME"] }
    },
    {
      "from": "UnderstandTheReference",
      "to": "AskNameImageSearch",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user has already sent an image of the product."
        }
      ],
      "contextPreconditions": { "preconditions": ["NO_USER_HAS_NAME"] }
    },
    {
      "from": "UnderstandTheReference",
      "to": "AskTheReferenceImage",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user has never sent a photo of the product they are looking for. They only mentioned wanting a product, but did not send a picture of reference"
        }
      ]
    },

    {
      "from": "AskNameImageSearch",
      "to": "UserSpecifiedNameImageSearch",
      "preconditions": [{ "type": "user_said", "value": "Me llamo [NAME]" }]
    },
    {
      "from": "UserSpecifiedNameImageSearch",
      "to": "RegisterUserNameImageSearch",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "addUserName",
          "description": "Use the provided name the user gave to you as the name parameter in the addUserName tool"
        }
      ]
    },
    {
      "from": "RegisterUserNameImageSearch",
      "to": "SearchProduct"
    },
    {
      "from": "GreetingAskName",
      "to": "UserSpecifiedName",
      "preconditions": [{ "type": "user_said", "value": "Me llamo [NAME]" }]
    },
    {
      "from": "UserSpecifiedName",
      "to": "RegisterUserName",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "addUserName",
          "description": "Use the provided name the user gave to you as the name parameter in the addUserName tool"
        }
      ]
    },
    {
      "from": "RegisterUserName",
      "to": "SearchIntent",
      "preconditions": [
        { "type": "user_said", "value": "Quisiera un [PRODUCTO] como..." }
      ]
    },
    {
      "from": "AskTheReferenceImage",
      "to": "UnderstandTheReference"
    },
    {
      "from": "SearchIntent",
      "to": "SearchProduct",
      "preconditions": [{ "type": "tool_call", "value": "searchProducts" }],
      "contextPreconditions": { "preconditions": ["NO_ASK_GENDER"] }
    },
    {
      "from": "SearchIntent",
      "to": "SearchProduct",
      "preconditions": [{ "type": "tool_call", "value": "searchProducts" }],
      "contextPreconditions": { "preconditions": ["NEVER_ASK_GENDER"] }
    },
    {
      "from": "SearchIntent",
      "to": "AskGenderAsSearchCriteria",
      "contextPreconditions": { "preconditions": ["ASK_GENDER"] }
    },
    {
      "from": "AskGenderAsSearchCriteria",
      "to": "ProceedWithGenderSelection",
      "preconditions": [
        { "type": "user_said", "value": "Para hombre o para mujer" }
      ]
    },
    {
      "from": "ProceedWithGenderSelection",
      "to": "SaveGenderBeforeSearch",
      "preconditions": [{ "type": "tool_call", "value": "saveUserGender" }]
    },
    {
      "from": "SaveGenderBeforeSearch",
      "to": "SearchProduct",
      "preconditions": [{ "type": "tool_call", "value": "searchProducts" }]
    },
    {
      "from": "AnswerProductQuestionSP",
      "to": "SingleProduct"
    },
    {
      "from": "SingleProduct",
      "to": "ShowSingleImage",
      "preconditions": [
        { "type": "user_said", "value": "Quisiera ver otra imagen" }
      ]
    },
    {
      "from": "SingleProduct",
      "to": "AnswerProductQuestionSP",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øcu√°l de los que me mostraste es el m√°s barato? o ¬øpor qu√© este producto me sirve? o ¬øpor qu√© me lo recomiendas? o ¬øqu√© tal es la calidad? o ¬øc√≥mo son los materiales? (pregunta que indica que quiere m√°s informaci√≥n)"
        }
      ]
    },
    {
      "from": "SingleProduct",
      "to": "AskInformation",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øEn qu√© color/talla/material/almacenamiento (personalizaci√≥n) esta disponible? (pregunta por disponibilidad de personalizaciones)"
        }
      ]
    },
    {
      "from": "SingleProduct",
      "to": "ConfirmAddCart",
      "preconditions": [{ "type": "user_said", "value": "S√≠ me gusta" }]
    },
    {
      "from": "SingleProduct",
      "to": "AskChanges",
      "preconditions": [{ "type": "user_said", "value": "No me gusta" }]
    },
    {
      "from": "SingleProduct",
      "to": "CheckProductPersonalizationsSP",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Lo tienes en otro material/tama√±o/talla/coloralmacenamiento (personalizaci√≥n)?"
        }
      ]
    },
    {
      "from": "SingleProduct",
      "to": "SearchIntent",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øQu√© otras opciones tienes? / Prefiero ver otro producto distinto, como ... [X, Y, Z], ¬øQu√© otras opciones tienes m√°s baratas?"
        }
      ]
    },
    {
      "from": "SingleProduct",
      "to": "ReturnToCartWithoutAddingNewItems",
      "preconditions": [
        {
          "type": "user_said",
          "value": "No me gusto, o deja as√≠, o solo dame el producto que ya tenia en el carrito"
        }
      ],
      "contextPreconditions": {
        "preconditions": ["USER_HAS_NONEMPTY_CART"],
        "jumpTo": "ContinueWithOrder"
      }
    },
    {
      "from": "SingleProduct",
      "to": "NotInterestedInSeeingAnyMore",
      "preconditions": [
        {
          "type": "user_said",
          "value": "No, gracias. Nada, as√≠ est√° bien, gracias por su atenci√≥n, dejemos as√≠"
        }
      ]
    },
    {
      "from": "SingleProduct",
      "to": "AskQuantity",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Quiero comprar el producto que me mostraste antes, los que vi antes"
        }
      ]
    },
    {
      "from": "CheckProductPersonalizationsSP",
      "to": "ExistingPersonalizationSP",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The product is available with the personalization the user is asking for"
        }
      ]
    },
    {
      "from": "CheckProductPersonalizationsSP",
      "to": "NonExistingPersonalizationSP",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The product is NOT available with the personalization the user is asking for"
        }
      ]
    },
    {
      "from": "ExistingPersonalizationSP",
      "to": "SingleProduct",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "sendImage",
          "description": "Send an image of the personalization the user is asking for"
        }
      ]
    },
    {
      "from": "NonExistingPersonalizationSP",
      "to": "InformNonExistingPersonalizationSP"
    },
    {
      "from": "InformNonExistingPersonalizationSP",
      "to": "CheckProductPersonalizationsSP",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Pregunto por la disponibilidad de una personalizaci√≥n espec√≠fica de un producto que ya me mostraste antes. Por ejemplo: ¬øTienes X producto que ya me mostraste antes, en el color/talla/material/estilo/almacenamiento X?"
        }
      ]
    },
    {
      "from": "InformNonExistingPersonalizationSP",
      "to": "AnswerProductPersonalizationsSP",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Pregunto por la disponibilidad de alguna personalizaci√≥n general de un producto que ya me mostraste antes. Por ejemplo: ¬øEn qu√© colores/tallas/materiales/estilos/almacenamientos lo tienes?"
        }
      ]
    },
    {
      "from": "AnswerProductPersonalizationsSP",
      "to": "DoAnswerProductPersonalizationSP",
      "contextPreconditions": {
        "preconditions": ["ALWAYS_TRUE"],
        "jumpTo": "SingleProduct"
      }
    },
    {
      "from": "InformNonExistingPersonalizationSP",
      "to": "ConfirmAddCart",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Quiero continuar con el color/talla/material/estilo/almacenamiento (personalizaci√≥n) X que me mostraste"
        }
      ]
    },
    {
      "from": "InformNonExistingPersonalizationSP",
      "to": "SearchIntent",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Entonces quiero otro [PRODUCTO] como..."
        }
      ]
    },
    {
      "from": "CheckProductPersonalizationsMP",
      "to": "ExistingPersonalizationMP",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The product is available with the personalization the user is asking for"
        }
      ]
    },
    {
      "from": "CheckProductPersonalizationsMP",
      "to": "NonExistingPersonalizationMP",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The product is NOT available with the personalization the user is asking for"
        }
      ]
    },
    {
      "from": "ExistingPersonalizationMP",
      "to": "MultipleProducts",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "sendImage",
          "description": "Send an image of the personalization the user is asking for"
        }
      ]
    },
    {
      "from": "NonExistingPersonalizationMP",
      "to": "InformNonExistingPersonalizationMP"
    },
    {
      "from": "InformNonExistingPersonalizationMP",
      "to": "AnswerProductPersonalizationsMP",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Pregunto por la disponibilidad de alguna personalizaci√≥n general de un producto que ya me mostraste antes. Por ejemplo: ¬øEn qu√© colores/tallas/materiales/estilos/almacenamientos lo tienes?"
        }
      ]
    },
    {
      "from": "AnswerProductPersonalizationsMP",
      "to": "DoAnswerProductPersonalizationMP",
      "contextPreconditions": {
        "preconditions": ["ALWAYS_TRUE"],
        "jumpTo": "MultipleProducts"
      }
    },
    {
      "from": "InformNonExistingPersonalizationMP",
      "to": "CheckProductPersonalizationsMP",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Pregunt√≥ por una personalizaci√≥n espec√≠fica de un producto que ya le mostraste antes. Por ejemplo: ¬øTienes X producto que ya me mostraste antes, en el color/talla/material/estilo/almacenamiento X?"
        }
      ]
    },
    {
      "from": "InformNonExistingPersonalizationMP",
      "to": "ConfirmAddCart",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Afirmo que quiero continuar con el color/talla/material/estilo/almacenamiento (personalizaci√≥n) X que ya me mostraste"
        }
      ]
    },
    {
      "from": "InformNonExistingPersonalizationMP",
      "to": "SearchIntent",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Entonces tienes otro [PRODUCTO] como..."
        }
      ]
    },
    {
      "from": "AnswerProductQuestionMP",
      "to": "MultipleProducts"
    },
    {
      "from": "MultipleProducts",
      "to": "ConfirmAddCart",
      "preconditions": [
        { "type": "user_said", "value": "Me gusta el producto [X]" }
      ]
    },
    {
      "from": "MultipleProducts",
      "to": "AnswerProductQuestionMP",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øcu√°l de los que me mostraste es el m√°s barato? o ¬øpor qu√© este producto me sirve? o ¬øpor qu√© me lo recomiendas? o ¬øqu√© tal es la calidad? o ¬øc√≥mo son los materiales? (pregunta que indica que quiere m√°s informaci√≥n)"
        }
      ]
    },
    {
      "from": "MultipleProducts",
      "to": "AskQuantity",
      "preconditions": [
        {
          "type": "user_said",
          "value": "\"Quiero comprar los que me mostraste antes\", o \"quiero los que ya me habias mostrado\", o \"quiero los primeros que me mostraste\""
        }
      ]
    },
    {
      "from": "MultipleProducts",
      "to": "SearchIntent",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øQu√© opciones m√°s baratas tienes?, ¬øQu√© otras opciones tienes en otro (precio, color, tama√±o, material)?"
        }
      ]
    },
    {
      "from": "MultipleProducts",
      "to": "AskChanges",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Ninguno me gust√≥"
        }
      ]
    },
    {
      "from": "MultipleProducts",
      "to": "NotInterestedInSeeingAnyMore",
      "preconditions": [
        {
          "type": "user_said",
          "value": "No, nada, as√≠ est√° bien, gracias por su atenci√≥n, dejemos as√≠"
        }
      ]
    },
    {
      "from": "MultipleProducts",
      "to": "CheckProductPersonalizationsMP",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øEl producto [X] (mostrado antes) est√° disponible en otro color/talla/material/almacenamiento?"
        }
      ]
    },
    {
      "from": "MultipleProducts",
      "to": "AskForNewDifferentProduct",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øTienen el producto [Y] (NO mostrado antes) en [Z] personalizaci√≥n? Me interesa saber si lo tienen en un (color, talla, material, almacenamiento) especifico. (Pregunta por un producto que NO se le hab√≠a mostrado antes)"
        }
      ]
    },
    {
      "from": "MultipleProducts",
      "to": "AskInformation",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øEn qu√© colores/tallas/materiales/almacenamiento (personalizaci√≥n) esta disponible?"
        }
      ]
    },
    {
      "from": "MultipleProducts",
      "to": "ReturnToCartWithoutAddingNewItems",
      "preconditions": [
        {
          "type": "user_said",
          "value": "No me gusto, o deja as√≠, o solo dame el producto que ya tenia en el carrito"
        }
      ],
      "contextPreconditions": {
        "preconditions": ["USER_HAS_NONEMPTY_CART"],
        "jumpTo": "ContinueWithOrder"
      }
    },
    {
      "from": "AskForNewDifferentProduct",
      "to": "SearchProduct",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "searchProducts"
        }
      ]
    },
    {
      "from": "AskInformation",
      "to": "ConfirmAddCart",
      "preconditions": [
        { "type": "user_said", "value": "Me gusta el producto [X]" }
      ]
    },
    {
      "from": "AskInformation",
      "to": "SearchIntent",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Es que estaba buscando algo con X, Y, Z caracter√≠sticas"
        }
      ]
    },
    {
      "from": "AskChanges",
      "to": "SearchIntent",
      "preconditions": [
        { "type": "user_said", "value": "Me gustar√≠a que tuviera..." }
      ]
    },
    {
      "from": "AskChanges",
      "to": "CheckIfMultipleProducts",
      "preconditions": [
        { "type": "user_said", "value": "Quiero seguir con este producto" }
      ]
    },
    {
      "from": "ConfirmAddCart",
      "to": "CheckIfMultipleProducts",
      "preconditions": [{ "type": "user_said", "value": "S√≠, agr√©galo" }]
    },
    {
      "from": "ConfirmAddCart",
      "to": "AskChanges",
      "preconditions": [{ "type": "user_said", "value": "No, no lo agregues" }]
    },
    {
      "from": "ConfirmAddCart",
      "to": "CheckProductPersonalizationsMP",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Pregunt√≥ por una personalizaci√≥n de un producto que ya le mostraste antes"
        }
      ]
    },
    {
      "from": "ConfirmAddCart",
      "to": "SearchIntent",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Prefiero buscar otro producto que tenga X caracteristica, o lo necesito con X, Y, Z, Me gustar√≠a que tuviera..."
        }
      ]
    },
    {
      "from": "CheckIfMultipleProducts",
      "to": "AskQuantity",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "User wants to add ONLY ONE KIND of products, that's means one product id)"
        }
      ]
    },
    {
      "from": "CheckIfMultipleProducts",
      "to": "AskMultipleQuantities",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "User wants to add MULTIPLE products (2 or more)"
        }
      ]
    },
    {
      "from": "AskQuantity",
      "to": "ProceedWithGivenQuantity",
      "preconditions": [{ "type": "user_said", "value": "Quiero X unidades" }]
    },
    {
      "from": "ProceedWithGivenQuantity",
      "to": "VerifyProductsWereAddedToCart",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "addMultipleItemsToCart",
          "description": "Collect all the products and their quantities the user wants to add. Group them into the items array. The \"personalizations\" property is optional and must be provided ONLY IF the user specified them explicitly. NEVER ask for personalizations."
        }
      ]
    },
    {
      "from": "AskMultipleQuantities",
      "to": "ProceedWithMultipleGivenQuantity",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Quiero X unidades del product Y, - Z unidades del product M, etc"
        }
      ]
    },
    {
      "from": "ProceedWithMultipleGivenQuantity",
      "to": "VerifyProductsWereAddedToCart",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "addMultipleItemsToCart",
          "description": "Collect all the product ids and their quantities the user wants to add, **do not ask for personalizations**. Group them into the items array for the tool call."
        }
      ]
    },
    {
      "from": "VerifyProductsWereAddedToCart",
      "to": "CartOptions",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The tool responded that the items were indeed successfully added to the cart."
        }
      ]
    },
    {
      "from": "VerifyProductsWereAddedToCart",
      "to": "ProductsWereNotAddedToCart",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The tool responded that one o more product could not be added to the cart due to an error."
        }
      ]
    },
    {
      "from": "ProductsWereNotAddedToCart",
      "to": "ProceedWithMultipleGivenQuantity",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Quiero continuar solo con los productos que SI estaban disponibles"
        }
      ]
    },
    {
      "from": "ProductsWereNotAddedToCart",
      "to": "WhatPersonalizationHasEnoughStock",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øCu√°les personalizaciones s√≠ estan disponibles? ¬øEn qu√© personalizaci√≥n (talla, color, material, almacenamiento) s√≠ tienes stock disponible? o pregunta por personalizaciones que s√≠ tengan suficiente stock"
        }
      ]
    },
    {
      "from": "ProductsWereNotAddedToCart",
      "to": "BuyMoreItems",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Quiero buscar un nuevo producto diferente al producto que no se agrego al carrito"
        }
      ]
    },
    {
      "from": "ProductsWereNotAddedToCart",
      "to": "ProceedWithMultipleGivenQuantity",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Quiero llevar el mismo producto en otra personalizaci√≥n"
        }
      ]
    },
    {
      "from": "WhatPersonalizationHasEnoughStock",
      "to": "ProceedWithMultipleGivenQuantity",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Dame X unidades del producto Z, y N unidades del producto M"
        }
      ]
    },
    {
      "from": "CartOptions",
      "to": "BuyMoreItems",
      "preconditions": [
        { "type": "user_said", "value": "Quiero comprar m√°s productos" }
      ]
    },
    {
      "from": "CartOptions",
      "to": "ContinueWithOrder",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Continuar / Avanzar / Terminar / Finalizar el pedido"
        }
      ]
    },
    {
      "from": "CartOptions",
      "to": "GetCart",
      "preconditions": [{ "type": "user_said", "value": "Ver carrito" }]
    },
    {
      "from": "CartOptions",
      "to": "RemoveItemFromCart",
      "preconditions": [{ "type": "user_said", "value": "Eliminar producto" }]
    },
    {
      "from": "CartOptions",
      "to": "ReplaceItemFromCart",
      "preconditions": [{ "type": "user_said", "value": "Reemplazar producto" }]
    },
    {
      "from": "BuyMoreItems",
      "to": "SearchIntent",
      "preconditions": [
        { "type": "user_said", "value": "Quisiera un producto X" }
      ]
    },
    { "from": "RemoveSuccess", "to": "CartOptions" },
    {
      "from": "WhichReplace",
      "to": "ReplaceItemSpecified",
      "preconditions": [
        { "type": "user_said", "value": "Quiero reemplazar el producto X" }
      ]
    },
    {
      "from": "WhatInstead",
      "to": "CheckReplacementType",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Quiero el producto X con personalizaci√≥n Y"
        }
      ]
    },
    {
      "from": "CheckReplacementType",
      "to": "AddSameProductWithNewPersonalization",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "Only is a personalization change, the name of the product is the same"
        }
      ]
    },
    {
      "from": "CheckReplacementType",
      "to": "SearchIntent",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "User wants to search a new product name"
        }
      ]
    },
    {
      "from": "AddSameProductWithNewPersonalization",
      "to": "CartOptions",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "addMultipleItemsToCart",
          "description": "Add the same product ID to cart with the new personalizations specified by the user. Use the product ID from the item that was just deleted. Wrap it in the items array. The personalizations MUST be provided based on what the user explicitly said they want."
        }
      ]
    },
    { "from": "ShowCart", "to": "CartOptions" },
    {
      "from": "CustomLink",
      "to": "UserSaidFormWasFilled",
      "preconditions": [
        { "type": "user_said", "value": "Listo, ya llen√© el formulario" }
      ]
    },
    { "from": "RemindCustom", "to": "RemindCustom", "preconditions": [] },
    {
      "from": "RemindCustom",
      "to": "RemindCustom1",
      "preconditions": [
        {
          "type": "user_said",
          "value": "\"Listo, llen√© el formulario\", o \"lo veo bien\", o \"ya est√°\""
        }
      ]
    },
    {
      "from": "AskCity",
      "to": "UserSpecifiedCity",
      "preconditions": [
        { "type": "user_said", "value": "Estoy en la ciudad X" }
      ]
    },
    {
      "from": "CityHasExactMatch",
      "to": "CalculatShippingFees",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "confirmShippingToCity",
          "description": "Use the full cityID obtained from the call to the tool \"searchCityId\" as the \"cityID\" parameter for this call. NEVER hallucinate nor shorten this cityID value."
        }
      ]
    },
    {
      "from": "ClarifyCity",
      "to": "ConfirmShippingToCity",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Eligi√≥ el nombre de una de las ciudades de la lista"
        }
      ]
    },
    {
      "from": "ClarifyCity",
      "to": "AskCity",
      "preconditions": [
        {
          "type": "user_said",
          "value": "No es esa, no es ninguna opci√≥n de la lista"
        }
      ]
    },
    { "from": "CalculatShippingFees", "to": "InformShippingFees" },
    {
      "from": "InformShippingFees",
      "to": "AskPayment",
      "preconditions": [{ "type": "user_said", "value": "S√≠" }]
    },
    {
      "from": "InformShippingFees",
      "to": "CartOptions",
      "preconditions": [{ "type": "user_said", "value": "No" }]
    },
    {
      "from": "AskPayment",
      "to": "AskPayment1",
      "preconditions": [{ "type": "user_said", "value": "Pago en l√≠nea" }]
    },
    {
      "from": "AskPayment",
      "to": "AskPayment2",
      "preconditions": [{ "type": "user_said", "value": "Pago contra entrega" }]
    },
    {
      "from": "AskPayment",
      "to": "AskPayment3",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Alguna de las opciones de transferencia (debe ser una opci√≥n espec√≠fica)"
        }
      ]
    },
    {
      "from": "AskPayment",
      "to": "AskPaymentInvalidOption",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Cualquier opci√≥n que no est√© expl√≠citamente en la lista (no es ni pago en l√≠nea ni pago contra entrega, ni una de las opciones de transferencia listadas espec√≠ficamente) o no espec√≠fico con cu√°l tipo de transferencia"
        }
      ]
    },
    {
      "from": "AskPaymentInvalidOption",
      "to": "AskPayment1",
      "preconditions": [{ "type": "user_said", "value": "Pago en l√≠nea" }]
    },
    {
      "from": "AskPaymentInvalidOption",
      "to": "AskPayment2",
      "preconditions": [{ "type": "user_said", "value": "Pago contra entrega" }]
    },
    {
      "from": "AskPaymentInvalidOption",
      "to": "AskPayment3",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Alguna de las opciones de transferencia (debe ser una opci√≥n espec√≠fica)"
        }
      ]
    },
    {
      "from": "AskPaymentInvalidOption",
      "to": "AskPaymentInvalidOption",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Una opci√≥n que no est√° en la lista (no es ni pago en l√≠nea ni pago contra entrega, ni una de las opciones de transferencia listadas espec√≠ficamente) o no espec√≠fico con cu√°l tipo de transferencia"
        }
      ]
    },
    {
      "from": "AskPayment2",
      "to": "ShowTotalCOD",
      "preconditions": [
        { "type": "tool_call", "value": "calculateTotalPayment" }
      ]
    },
    { "from": "ShowTotalCOD", "to": "ShowOrderSummary" },
    {
      "from": "ShowOrderSummary",
      "to": "AskDataCOD",
      "preconditions": [{ "type": "user_said", "value": "S√≠, confirmo" }]
    },
    {
      "from": "ShowOrderSummary",
      "to": "OrderCancelled",
      "preconditions": [{ "type": "user_said", "value": "No, no confirmo" }]
    },
    {
      "from": "AskDataCOD",
      "to": "ValidateCODData",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Mi nombre es Pepito, correo..., c√©dula..., direcci√≥n..."
        }
      ]
    },
    {
      "from": "ValidateCODData",
      "to": "RequestMissingDataCOD",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "One or more required fields are missing, invalid, ambiguos, or incomplete (the \"barrio\" parameter IS ALSO MANDATORY, AND, the address must be unambiguos, otherwise, select this option and ask a clarifying address)"
        }
      ]
    },
    {
      "from": "RequestMissingDataCOD",
      "to": "CreateCODOrder",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "All required fields are present, valid, and complete"
        }
      ]
    },
    {
      "from": "RequestMissingDataCOD",
      "to": "ValidateCODData",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "One or more required fields are missing, invalid, ambiguos, or incomplete (the \"barrio\" parameter IS ALSO MANDATORY, AND, the address must be unambiguos, otherwise, select this option and ask a clarifying address)"
        }
      ]
    },
    {
      "from": "ValidateCODData",
      "to": "CreateCODOrder",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "All required fields are present, valid, and complete"
        }
      ]
    },
    {
      "from": "CreateCODOrder",
      "to": "OrderSuccess",
      "preconditions": [
        { "type": "tool_call", "value": "createCashOnDeliveryOrder" }
      ]
    },
    { "from": "OrderCancelled", "to": "CartOptions" },
    {
      "from": "SearchProduct",
      "to": "NoProductsFound",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "the tool search did not found any (0) products"
        }
      ]
    },
    {
      "from": "SearchProduct",
      "to": "ShowSingleImage",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "the tool search found only one (1) product"
        }
      ]
    },
    {
      "from": "SearchProduct",
      "to": "ShowSeveralImages",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "the tool search found more than one (>1) product"
        }
      ]
    },
    {
      "from": "NoProductsFound",
      "to": "SearchIntent",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øQu√© otras opciones tienes? √≥, quiero un [PRODUCTO] como..."
        }
      ]
    },
    {
      "from": "NoProductsFound",
      "to": "AskQuantity",
      "preconditions": [
        {
          "type": "user_said",
          "value": "\"Quiero comprar los que me mostraste antes\", o \"quiero los que ya me habias mostrado\", o \"quiero los primeros que me mostraste\""
        }
      ]
    },
    {
      "from": "NoProductsFound",
      "to": "NotInterestedInSeeingAnyMore",
      "preconditions": [
        {
          "type": "user_said",
          "value": "No gracias, ya no me interesa nada m√°s o No, asi esta bien"
        }
      ],
      "contextPreconditions": { "preconditions": ["USER_HAS_EMPTY_CART"] }
    },
    {
      "from": "NoProductsFound",
      "to": "ReturnToCartWithoutAddingNewItems",
      "preconditions": [
        {
          "type": "user_said",
          "value": "No me gusto, o deja as√≠, o solo dame el producto que ya tenia en el carrito"
        }
      ],
      "contextPreconditions": {
        "preconditions": ["USER_HAS_NONEMPTY_CART"],
        "jumpTo": "ContinueWithOrder"
      }
    },
    {
      "from": "ShowSingleImage",
      "to": "GenerateProductCard",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "sendImage",
          "description": "Call the tool \"sendImage\" NOW. Do not request any additional information, do not ask for customizations, just call the tool NOW. Provide the tool with the ID of the image you want to send to the user, you obtained this ID in the result of the call to the tool \"searchProducts\""
        }
      ]
    },
    {
      "from": "GenerateProductCard",
      "to": "SingleProduct",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "productCards",
          "description": "Call the tool \"productCards\" NOW."
        }
      ]
    },
    {
      "from": "ShowSeveralImages",
      "to": "GenerateProductCards",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "sendImages",
          "description": "IMMEDIATELY call the tool \"sendImages\". Your ONLY task is to execute the tool call - do NOT send any text message, do NOT ask questions, do NOT provide options. Simply call the tool with an array of product IDs from search results. Include one image ID per distinct product (max 3). If multiple personalizations exist, pick one automatically. The tool itself sends the images to the user."
        }
      ]
    },
    {
      "from": "GenerateProductCards",
      "to": "MultipleProducts",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "productCards",
          "description": "Call the tool \"productCards\" NOW."
        }
      ]
    },
    {
      "from": "UserSaidFormWasFilled",
      "to": "ConfirmCustomFormWasFilled",
      "preconditions": [
        { "type": "tool_call", "value": "confirmOrderCustomization" }
      ]
    },
    {
      "from": "ConfirmCustomFormWasFilled",
      "to": "AskCity",
      "preconditions": [
        { "type": "agent_decision", "value": "The user DID complete the form" }
      ]
    },
    {
      "from": "ConfirmCustomFormWasFilled",
      "to": "RemindCustom",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user did NOT complete the form"
        }
      ]
    },
    {
      "from": "RemindCustom1",
      "to": "RemindCustom2",
      "preconditions": [
        { "type": "tool_call", "value": "confirmOrderCustomization" }
      ]
    },
    {
      "from": "RemindCustom2",
      "to": "AskCity",
      "preconditions": [
        { "type": "agent_decision", "value": "The user DID complete the form" }
      ]
    },
    {
      "from": "RemindCustom2",
      "to": "RemindCustom",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user did NOT complete the form"
        }
      ]
    },
    {
      "from": "ContinueWithOrder",
      "to": "CustomLink",
      "preconditions": [
        { "type": "tool_call", "value": "createOrderCustomization" }
      ]
    },
    {
      "from": "GetCart",
      "to": "ShowCart",
      "preconditions": [{ "type": "tool_call", "value": "getCart" }]
    },
    {
      "from": "RemoveItemFromCart",
      "to": "UserDidNotSpecifyItemToRemove",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user did NOT specify which product to remove"
        }
      ]
    },
    {
      "from": "RemoveItemFromCart",
      "to": "UserSpecifiedItemToRemove",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user DID specify which product to remove"
        }
      ]
    },
    {
      "from": "UserDidNotSpecifyItemToRemove",
      "to": "WhichRemove",
      "preconditions": [{ "type": "tool_call", "value": "getCart" }]
    },
    {
      "from": "UserSpecifiedItemToRemove",
      "to": "RemoveSuccess",
      "preconditions": [{ "type": "tool_call", "value": "deleteCartItem" }]
    },
    {
      "from": "ReplaceItemFromCart",
      "to": "UserSpecifiedItemToReplace",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user DID specify which product to replace"
        }
      ]
    },
    {
      "from": "ReplaceItemFromCart",
      "to": "UserDidNotSpecifyItemToReplace",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The user did NOT specify which product to replace"
        }
      ]
    },
    {
      "from": "UserSpecifiedItemToReplace",
      "to": "WhatInstead",
      "preconditions": [{ "type": "tool_call", "value": "deleteCartItem" }]
    },
    {
      "from": "UserDidNotSpecifyItemToReplace",
      "to": "WhichReplace",
      "preconditions": [{ "type": "tool_call", "value": "getCart" }]
    },
    {
      "from": "ReplaceItemSpecified",
      "to": "WhatInstead",
      "preconditions": [{ "type": "tool_call", "value": "deleteCartItem" }]
    },
    {
      "from": "UserSpecifiedCity",
      "to": "AskCity2",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "searchCityId",
          "description": "If the user says a city name (e.g. 'Medell√≠n'), call `searchCityId` with: { \"city\": \"<city>\" }.\nExample: user says 'Bogot√°' ‚Üí call `searchCityId` with input {\"city\": \"Bogot√°\"}."
        }
      ]
    },
    {
      "from": "AskCity2",
      "to": "CityHasExactMatch",
      "preconditions": [
        { "type": "agent_decision", "value": "City had an exact match" }
      ]
    },
    {
      "from": "AskCity2",
      "to": "ClarifyCity",
      "preconditions": [
        { "type": "agent_decision", "value": "City had several matches" }
      ]
    },
    {
      "from": "AskCity2",
      "to": "CityDoesNotExist",
      "preconditions": [
        { "type": "agent_decision", "value": "No city was found" }
      ]
    },
    {
      "from": "CityDoesNotExist",
      "to": "UserSpecifiedCity",
      "preconditions": [
        { "type": "user_said", "value": "Nuevo nombre de ciudad corregido" }
      ]
    },
    {
      "from": "ConfirmShippingToCity",
      "to": "CalculatShippingFees",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "confirmShippingToCity",
          "description": "Use the full cityID obtained from the call to the tool \"searchCityId\" as the \"cityID\" parameter for this call. NEVER hallucinate nor shorten this cityID value."
        }
      ]
    },

    {
      "from": "AskPayment3",
      "to": "CalculateTotalTransference",
      "preconditions": [
        { "type": "tool_call", "value": "calculateTotalPayment" }
      ]
    },
    { "from": "CalculateTotalTransference", "to": "ShowTotalTransference" },
    {
      "from": "ShowTotalTransference",
      "to": "AskDataTransference",
      "preconditions": [{ "type": "user_said", "value": "S√≠, confirmo" }]
    },
    {
      "from": "ShowTotalTransference",
      "to": "CartOptions",
      "preconditions": [{ "type": "user_said", "value": "No, no confirmo" }]
    },
    {
      "from": "AskDataTransference",
      "to": "ValidateTransferenceData",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Mi nombre es Pepito, correo..., c√©dula..., direcci√≥n..."
        }
      ]
    },
    {
      "from": "ValidateTransferenceData",
      "to": "RequestMissingDataTransference",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "One or more required fields are missing, invalid, ambiguos, or incomplete (the \"barrio\" parameter IS ALSO MANDATORY, AND, the address must be unambiguos, otherwise, select this option and ask a clarifying address)"
        }
      ]
    },
    {
      "from": "RequestMissingDataTransference",
      "to": "CreateTransferencePayment",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "All required fields are present, valid, and complete"
        }
      ]
    },
    {
      "from": "RequestMissingDataTransference",
      "to": "ValidateTransferenceData",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "One or more required fields are missing, invalid, ambiguos, or incomplete (the \"barrio\" parameter IS ALSO MANDATORY, AND, the address must be unambiguos, otherwise, select this option and ask a clarifying address)"
        }
      ]
    },
    {
      "from": "ValidateTransferenceData",
      "to": "CreateTransferencePayment",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "All required fields are present, valid, and complete, and documentoIdentidad has 10 digits at maximum"
        }
      ]
    },
    {
      "from": "CreateTransferencePayment",
      "to": "ShowTransferenceDetails",
      "preconditions": [
        { "type": "tool_call", "value": "getTransferenceDetails" }
      ]
    },
    {
      "from": "ShowTransferenceDetails",
      "to": "ShowTransferenceDetails1",
      "preconditions": [
        {
          "type": "user_said",
          "value": "el usuario dice \"ya pagu√©, mira la captura de pantalla del comprobante\" o expl√≠citamente en su √öLTIMO mensaje informa que no pudo tomar la captura de pantalla, por ejemplo \"ya pagu√©, pero no tom√© captura\" o \"no tom√© captura\""
        }
      ]
    },
    {
      "from": "ShowTransferenceDetails",
      "to": "AskPaymentScreenshot",
      "preconditions": [
        {
          "type": "user_said",
          "value": "el usuario dice \"ya pagu√©\", pero NO ha enviado captura de pantalla del comprobante NI TAMPOCO ha dicho expl√≠citamente que NO TOM√ì la captura"
        }
      ]
    },
    {
      "from": "AskPaymentScreenshot",
      "to": "ShowTransferenceDetails1",
      "preconditions": [
        {
          "type": "user_said",
          "value": "el usuario env√≠a la captura de pantalla de la transferencia o expl√≠citamente indica que NO tom√≥ captura de pantalla"
        }
      ]
    },
    {
      "from": "AskPaymentScreenshot",
      "to": "ShowTransferenceDetails",
      "preconditions": [
        {
          "type": "user_said",
          "value": "el usuario pide verificar los datos de la cuenta de destino"
        }
      ]
    },
    {
      "from": "ShowTransferenceDetails1",
      "to": "WaitForTransferenceConfirmation",
      "preconditions": [
        {
          "type": "tool_call",
          "value": "waitForTransferenceVerification",
          "description": "You do not need a screenshot to call this tool, you must call this tool NOW"
        }
      ]
    },
    {
      "from": "WaitForTransferenceConfirmation",
      "to": "ShowTransferenceDetails2"
    },
    {
      "from": "ShowTransferenceDetails2",
      "to": "OrderSuccess",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The tool result confirmed the payment"
        }
      ]
    },
    {
      "from": "ShowTransferenceDetails2",
      "to": "PaymentPendingTransference",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The tool result did not confirm the payment"
        }
      ]
    },
    {
      "from": "PaymentPendingTransference",
      "to": "PaymentPendingTransference1",
      "preconditions": [
        {
          "type": "user_said",
          "value": "el usuario dice \"ya pagu√©, mira la captura de pantalla del comprobante\" o expl√≠citamente en su √öLTIMO mensaje informa que no pudo tomar la captura de pantalla, por ejemplo \"ya pagu√©, pero no tom√© captura\" o \"no tom√© captura\""
        }
      ]
    },
    {
      "from": "PaymentPendingTransference",
      "to": "AskPaymentScreenshot",
      "preconditions": [
        {
          "type": "user_said",
          "value": "el usuario dice \"ya pagu√©\", pero NO ha enviado captura de pantalla del comprobante NI TAMPOCO ha dicho expl√≠citamente que no pudo tomar captura"
        }
      ]
    },
    {
      "from": "PaymentPendingTransference1",
      "to": "ShowTransferenceDetails1"
    },
    {
      "from": "AskPayment1",
      "to": "CalculateTotalOnline",
      "preconditions": [
        { "type": "tool_call", "value": "calculateTotalPayment" }
      ]
    },
    { "from": "CalculateTotalOnline", "to": "ShowTotalOnline" },
    {
      "from": "ShowTotalOnline",
      "to": "AskDataOnline",
      "preconditions": [{ "type": "user_said", "value": "S√≠, confirmo" }]
    },
    {
      "from": "ShowTotalOnline",
      "to": "CartOptions",
      "preconditions": [{ "type": "user_said", "value": "No, no confirmo" }]
    },
    {
      "from": "AskDataOnline",
      "to": "ValidateOnlineData",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Mi nombre es Pepito, correo..., c√©dula..., direcci√≥n..."
        }
      ]
    },
    {
      "from": "ValidateOnlineData",
      "to": "RequestMissingDataOnline",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "One or more required fields are missing, invalid, ambiguos, or incomplete (the \"barrio\" parameter IS ALSO MANDATORY, AND, the address must be unambiguos, otherwise, select this option and ask a clarifying address)"
        }
      ]
    },
    {
      "from": "RequestMissingDataOnline",
      "to": "CreateOnlinePayment",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "All required fields are present, valid, and complete"
        }
      ]
    },
    {
      "from": "RequestMissingDataOnline",
      "to": "ValidateOnlineData",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "One or more required fields are missing, invalid, ambiguos, or incomplete (the \"barrio\" parameter IS ALSO MANDATORY, AND, the address must be unambiguos, otherwise, select this option and ask a clarifying address)"
        }
      ]
    },
    {
      "from": "ValidateOnlineData",
      "to": "CreateOnlinePayment",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "All required fields are present, valid, and complete, and documentoIdentidad has 10 digits at maximum"
        }
      ]
    },
    {
      "from": "CreateOnlinePayment",
      "to": "ShowPayLink",
      "preconditions": [{ "type": "tool_call", "value": "createPaymentLink" }]
    },
    {
      "from": "ShowPayLink",
      "to": "ShowPayLink1",
      "preconditions": [{ "type": "user_said", "value": "¬°Ya pagu√©!" }]
    },
    {
      "from": "ShowPayLink1",
      "to": "ShowPayLink2",
      "preconditions": [{ "type": "tool_call", "value": "verifyPayment" }]
    },
    {
      "from": "ShowPayLink2",
      "to": "OrderSuccess",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The tool result confirmed the payment"
        }
      ]
    },
    {
      "from": "ShowPayLink2",
      "to": "PaymentPending",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The tool result did not confirm the payment"
        }
      ]
    },
    {
      "from": "PaymentPending",
      "to": "PaymentPending1",
      "preconditions": [{ "type": "user_said", "value": "¬°Ya pagu√©!" }]
    },
    {
      "from": "PaymentPending1",
      "to": "PaymentPending2",
      "preconditions": [{ "type": "tool_call", "value": "verifyPayment" }]
    },
    {
      "from": "PaymentPending2",
      "to": "OrderSuccess",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The tool result confirmed the payment"
        }
      ]
    },
    {
      "from": "OrderSuccess",
      "to": "UserDoesNotNeedAnythingElse",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Gracias, eso es todo o no necesito nada m√°s"
        }
      ]
    },
    {
      "from": "OrderSuccess",
      "to": "TrackingOrderStatus",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øC√≥mo va mi pedido? o ¬øCu√°ndo llega mi pedido? o p√°same la gu√≠a de env√≠o"
        }
      ]
    },
    {
      "from": "NotInterestedInSeeingAnyMore",
      "to": "UserDoesNotNeedAnythingElse",
      "preconditions": [
        {
          "type": "user_said",
          "value": "No, no necesito nada m√°s, gracias, eso era todo"
        }
      ]
    },
    {
      "from": "NotInterestedInSeeingAnyMore",
      "to": "RegisterUserName",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Si, necesito ayuda con algo: busco, quiero, necesito [X]"
        }
      ]
    },
    {
      "from": "PaymentPending2",
      "to": "PaymentPending",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "The tool result did not confirm the payment"
        }
      ]
    },
    {
      "from": "RegisterUserName",
      "to": "TrackingOrderStatus",
      "preconditions": [
        {
          "type": "user_said",
          "value": "¬øC√≥mo va mi pedido? o ¬øCu√°ndo llega mi pedido? o p√°same la gu√≠a de env√≠o"
        }
      ]
    },
    {
      "from": "TrackingOrderStatus",
      "to": "InterpretOrderStatus",
      "preconditions": [{ "type": "tool_call", "value": "getOrders" }]
    },
    {
      "from": "InterpretOrderStatus",
      "to": "OrderUnpaid",
      "preconditions": [
        { "type": "agent_decision", "value": "Order status is unpaid" }
      ]
    },
    {
      "from": "InterpretOrderStatus",
      "to": "OrderPaidUnconfirmed",
      "preconditions": [
        {
          "type": "agent_decision",
          "value": "Order status is paid/unconfirmed"
        }
      ]
    },
    {
      "from": "InterpretOrderStatus",
      "to": "OrderConfirmed",
      "preconditions": [
        { "type": "agent_decision", "value": "Order status is confirmed" }
      ]
    },
    {
      "from": "InterpretOrderStatus",
      "to": "OrderSent",
      "preconditions": [
        { "type": "agent_decision", "value": "Order status is sent/enviado" }
      ]
    },
    {
      "from": "InterpretOrderStatus",
      "to": "OrderReceived",
      "preconditions": [
        { "type": "agent_decision", "value": "Order status is received" }
      ]
    },
    {
      "from": "InterpretOrderStatus",
      "to": "OrderCancelledTracking",
      "preconditions": [
        { "type": "agent_decision", "value": "Order status is cancelled" }
      ]
    },
    {
      "from": "InterpretOrderStatus",
      "to": "OrderPaymentFailed",
      "preconditions": [
        { "type": "agent_decision", "value": "Order status is payment-failed" }
      ]
    },
    {
      "from": "InterpretOrderStatus",
      "to": "NoOrdersFound",
      "preconditions": [
        { "type": "agent_decision", "value": "No orders found for user" }
      ]
    },
    {
      "from": "OrderSent",
      "to": "OfferTrackingGuide",
      "preconditions": [
        { "type": "agent_decision", "value": "trackingId exists in response" }
      ]
    },
    {
      "from": "OrderSent",
      "to": "TrackingIdNotFound",
      "preconditions": [
        { "type": "agent_decision", "value": "No trackingId exists" }
      ]
    },
    {
      "from": "TrackingIdNotFound",
      "to": "AskMoreTracking",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Vale, gracias, esperar√© que me la envies"
        }
      ]
    },
    {
      "from": "OfferTrackingGuide",
      "to": "UserWantsGuide",
      "preconditions": [
        { "type": "user_said", "value": "User responds to guide offer" }
      ]
    },
    {
      "from": "UserWantsGuide",
      "to": "SendTrackingGuide",
      "preconditions": [
        { "type": "agent_decision", "value": "User wants the guide" }
      ]
    },
    {
      "from": "UserWantsGuide",
      "to": "TrackingGuideDeclined",
      "preconditions": [
        { "type": "agent_decision", "value": "User declined the guide" }
      ]
    },
    {
      "from": "SendTrackingGuide",
      "to": "ReceiptInformation",
      "preconditions": [{ "type": "tool_call", "value": "sendTrackingID" }]
    },
    {
      "from": "ReceiptInformation",
      "to": "AskMoreTracking"
    },
    {
      "from": "TrackingGuideDeclined",
      "to": "AskMoreTracking"
    },
    {
      "from": "OrderUnpaid",
      "to": "AskMoreTracking"
    },
    {
      "from": "OrderPaidUnconfirmed",
      "to": "AskMoreTracking"
    },
    {
      "from": "OrderConfirmed",
      "to": "AskMoreTracking"
    },
    {
      "from": "OrderReceived",
      "to": "AskMoreTracking"
    },
    {
      "from": "OrderCancelledTracking",
      "to": "AskMoreTracking"
    },
    {
      "from": "OrderPaymentFailed",
      "to": "AskMoreTracking"
    },
    {
      "from": "NoOrdersFound",
      "to": "AskMoreTracking"
    },
    {
      "from": "AskMoreTracking",
      "to": "InterpretOrderStatus",
      "preconditions": [
        {
          "type": "user_said",
          "value": "tengo otra duda / necesito tambi√©n otra cosa..."
        }
      ]
    },
    {
      "from": "AskMoreTracking",
      "to": "UserDoesNotNeedAnythingElse",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Eso es todo, muchas gracias, no necesito nada m√°s"
        }
      ]
    },
    {
      "from": "AskMoreTracking",
      "to": "RegisterUserName",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Ya no necesito nada m√°s sobre mi pedido, pero quiero preguntarte otra cosa"
        }
      ]
    },
    {
      "from": "UserDoesNotNeedAnythingElse",
      "to": "RegisterUserName",
      "preconditions": [
        {
          "type": "user_said",
          "value": "Hola, tengo una pregunta, o necesito saber algo"
        }
      ]
    }
  ]
}
